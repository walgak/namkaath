{% extends 'base.html' %}
{% load static %}

{% block title %}Our Work | NAMKAATH{% endblock %}

{% block content %}
    <!-- Header -->
    <header class="page-header animate-on-scroll">
        <h1>Our Work Portfolio</h1>
        <p style="color: var(--text-muted); font-size: 1.2rem; max-width: 600px; margin: 0 auto;">
            Delivering impact through code. Explore a selection of our recent projects and success stories.
        </p>
    </header>

    <!-- Project Filters -->
    <div class="portfolio-filters animate-on-scroll">
        <button class="filter-btn active" data-filter="all">All Projects</button>
        <button class="filter-btn" data-filter="mobile">Mobile Apps</button>
        <button class="filter-btn" data-filter="web">Web Platforms</button>
        <button class="filter-btn" data-filter="ai">AI & Data</button>
    </div>

    <!-- Projects Grid (Dynamic) -->
    <div class="projects-grid" id="projectsGrid">
        {% for project in projects %}
        <div class="project-card animate-on-scroll" data-category="{{ project.category }}">
            <div class="project-img">
                {% if project.image %}
                    <img src="{{ project.image.url }}" alt="{{ project.title }}">
                {% else %}
                    <!-- Fallback image if none uploaded -->
                    <img src="https://placehold.co/600x400/1e293b/ffffff?text={{ project.title }}" alt="Project">
                {% endif %}
                <div class="project-overlay">
                    {% if project.link %}
                    <a href="{{ project.link }}" target="_blank" class="btn btn-primary"><i class="fa-solid fa-link"></i> View Project</a>
                    {% else %}
                    <span class="btn btn-outline" style="color: white; border-color: white;">Internal Project</span>
                    {% endif %}
                </div>
            </div>
            <div class="project-content">
                <div class="project-tags">
                    <span class="mini-tag">{{ project.get_category_display }}</span>
                </div>
                <h3 class="project-title">{{ project.title }}</h3>
                <p class="project-desc">{{ project.description|truncatechars:100 }}</p>
                <p style="font-size: 0.85rem; color: var(--text-muted);"><i class="fa-solid fa-code"></i> {{ project.tech_stack }}</p>
            </div>
        </div>
        {% empty %}
        <p style="color: var(--text-muted); text-align: center; grid-column: 1/-1;">No projects added yet. Visit the Admin panel to add some!</p>
        {% endfor %}
    </div>

    <!-- Testimonials Section (Static for now) -->
    <section class="testimonials-section">
        <div class="section-header animate-on-scroll">
            <h2>What Clients Say</h2>
            <p style="color: var(--text-muted);">Trusted by startups and enterprises alike.</p>
        </div>
        <!-- ... existing testimonials HTML ... -->
        <!-- (Keep the testimonials HTML from previous file here) -->
         <div class="testimonial-grid">
            <!-- Review 1 -->
            <div class="testimonial-card animate-on-scroll">
                <i class="fa-solid fa-quote-left quote-icon"></i>
                <div class="stars">
                    <i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i>
                </div>
                <p style="color: var(--text-main); font-style: italic;">"NAMKAATH transformed our outdated system into a sleek, high-performance web app."</p>
                <div class="client-info">
                    <img src="https://placehold.co/50x50/2563eb/ffffff?text=JS" class="client-avatar" alt="Client">
                    <div>
                        <h4 style="font-size: 1rem; margin: 0;">James Sullivan</h4>
                        <span style="font-size: 0.85rem; color: var(--text-muted);">CTO, FinCorp</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="section" style="text-align: center; background: var(--bg-body);">
        <div class="animate-on-scroll">
            <h2 style="margin-bottom: 1rem;">Have a Project in Mind?</h2>
            <p style="color: var(--text-muted); margin-bottom: 2rem;">Join our list of happy clients.</p>
            <a href="{% url 'contact' %}" class="btn btn-primary">Start Your Project</a>
        </div>
    </section>
{% endblock %}

{% block extra_js %}
    <script>
        const filterBtns = document.querySelectorAll('.filter-btn');
        const projects = document.querySelectorAll('.project-card');

        filterBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                filterBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                const filterValue = btn.getAttribute('data-filter');

                projects.forEach(project => {
                    const category = project.getAttribute('data-category');
                    if (filterValue === 'all' || filterValue === category) {
                        project.classList.remove('hide');
                        project.classList.add('show');
                    } else {
                        project.classList.remove('show');
                        project.classList.add('hide');
                    }
                });
            });
        });
    </script>
{% endblock %}